open Core
open Async
open C8.Programmable_cpu_core
open Helper

(* Test contents were created by c8asm, do not modify by hand *)

let%expect_test "Draw two characters" =
  test_bytes
    ~run_for_cycles:(rough_cycles_per_second * 1)
    ~print_at_interval:(rough_cycles_per_second * 1)
    ~rom:[ 0x00 ; 0xE0 ; 0x60 ; 0x02 ; 0x61 ; 0x02 ; 0x62 ; 0x00 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0x60 ; 0x02 ; 0x71 ; 0x08 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ; 0xF2 ; 0x29 ; 0xD0 ; 0x15 ; 0x70 ; 0x05 ; 0x72 ; 0x01 ]  ~create
    ();
  [%expect
    {|
      WARN: Sound is not implemented
      ⡏⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⢹
      ⡇⠀⢰⡶⠶⢶⡆⠀⢀⣰⡆⠀⠰⠶⠶⢶⡆⠰⠶⠶⢶⡆⢰⡆⠀⢰⡆⢰⡶⠶⠶⠆⢰⡶⠶⠶⠆⠰⠶⠶⢶⡆⢰⡶⠶⢶⡆⢰⡶⠶⢶⡆⢰⡶⠶⢶⡆⢰⡶⠶⢆⡀⠀⠀⢸
      ⡇⠀⢸⡇⠀⢸⡇⠀⠈⢹⡇⠀⢰⡶⠶⠾⠇⠰⠶⠶⢾⡇⠸⠷⠶⢾⡇⠸⠷⠶⢶⡆⢸⡷⠶⢶⡆⠀⢀⡰⠎⠁⢸⡷⠶⢾⡇⠸⠷⠶⢾⡇⢸⡷⠶⢾⡇⢸⡷⠶⢎⡁⠀⠀⢸
      ⡇⠀⠸⠷⠶⠾⠇⠀⠰⠾⠷⠆⠸⠷⠶⠶⠆⠰⠶⠶⠾⠇⠀⠀⠀⠸⠇⠰⠶⠶⠾⠇⠸⠷⠶⠾⠇⠀⠸⠇⠀⠀⠸⠷⠶⠾⠇⠰⠶⠶⠾⠇⠸⠇⠀⠸⠇⠸⠷⠶⠎⠁⠀⠀⢸
      ⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸
      ⡇⠀⢰⡶⠶⠶⠆⢰⡶⠶⢆⡀⢰⡶⠶⠶⠆⢰⡶⠶⠶⠆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸
      ⡇⠀⢸⡇⠀⠀⠀⢸⡇⠀⢸⡇⢸⡷⠶⠶⠆⢸⡷⠶⠶⠆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸
      ⡇⠀⠸⠷⠶⠶⠆⠸⠷⠶⠎⠁⠸⠷⠶⠶⠆⠸⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸
      ⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸
      ⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸
      ⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸
      ⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸
      ⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸
      ⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸
      ⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸
      ⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸
      ⠓⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠒⠚ |}];
  return ()
;;
